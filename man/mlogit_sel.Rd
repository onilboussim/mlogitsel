% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mlogit_sel.R
\name{mlogit_sel}
\alias{mlogit_sel}
\title{Multinomial Logit Model with Sample Selection}
\usage{
mlogit_sel(
  Y,
  S,
  X,
  Z,
  baseline_last = TRUE,
  init_beta = NULL,
  init_gamma = NULL
)
}
\arguments{
\item{Y}{Numeric vector of outcomes (categorical variable)}

\item{S}{Binary vector indicating selection (1 = observed, 0 = not observed)}

\item{X}{Matrix of covariates for the outcome equation}

\item{Z}{Matrix of additional covariates for the selection equation}

\item{baseline_last}{Logical, if TRUE the last category is baseline (default TRUE)}

\item{init_beta}{Optional list of initial values for beta parameters}

\item{init_gamma}{Optional list of initial values for gamma parameters}
}
\value{
A list containing:
  \item{delta}{Selection equation coefficients}
  \item{beta}{List of outcome equation coefficients for each category}
  \item{gamma}{List of dependence parameters for each category}
  \item{q}{Number of outcome categories}
  \item{convergence}{Convergence code from optimization (0 = success)}
  \item{logLik}{Log-likelihood value at convergence}
  \item{theta_hat}{Vector of all estimated parameters (beta, gamma)}
  \item{nu_hat}{Fitted selection probabilities}
  \item{Y_mapped}{Mapped outcome values}
  \item{X}{Covariate matrix (stored for bootstrap)}
  \item{S}{Selection vector (stored for bootstrap)}
}
\description{
Estimates a multinomial logit model with sample selection correction using
a two-step approach. First estimates the selection equation, then estimates
the outcome equation accounting for selection bias through a copula-based
dependence structure.
}
\examples{
\dontrun{
# Generate example data
set.seed(123)
n <- 500
X <- cbind(intercept = 1, x1 = rnorm(n), x2 = rnorm(n))
Z <- cbind(z1 = rnorm(n), z2 = rnorm(n))
W <- cbind(X, Z)

# Generate selection
delta_true <- c(0.5, 0.02, 0.1, -0.3, 0.05)
prob_select <- plogis(W \%*\% delta_true)
S <- rbinom(n, 1, prob_select)

# Generate outcomes
eta1 <- X \%*\% c(-1, 0.05, 0.2)
eta2 <- X \%*\% c(0.5, -0.03, 0.15)
probs <- exp(cbind(eta1, eta2, 0))
probs <- probs / rowSums(probs)
Y <- apply(probs, 1, function(p) sample(0:2, 1, prob = p))
Y[S == 0] <- NA

# Fit model
result <- mlogit_sel(Y = Y, S = S, X = X, Z = Z)
print(result)
}
}
